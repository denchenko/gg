{{- if not .MergeRequests}}
No open merge requests found.
{{- else}}
{{- $totalMRs := len .MergeRequests}}
{{- $readyToMerge := 0}}
{{- $stalled := 0}}
{{- range .MergeRequests}}
{{- if gte .ApprovalCount 2}}
{{- $readyToMerge = add $readyToMerge 1}}
{{- end}}
{{- if .IsStalled}}
{{- $stalled = add $stalled 1}}
{{- end}}
{{- end}}
{{$totalMRs}} total, {{$readyToMerge}} ready-to-merge, {{$stalled}} stalled
{{- $hasCurrentProject := false}}
{{- range .MergeRequests}}
{{- if .IsCurrentProject}}
{{- $hasCurrentProject = true}}
{{- end}}
{{- end}}

{{- if $hasCurrentProject}}
{{- $currentProjectName := ""}}
{{- range .MergeRequests}}
{{- if .IsCurrentProject}}
{{- $currentProjectName = (printf "%s" .WebURL | getProjectName)}}
{{- end}}
{{- end}}
{{formatBoxTitle (bold $currentProjectName)}}
│
{{- $hasCurrentBranch := false}}
{{- range .MergeRequests}}
{{- if .IsCurrentBranch}}
{{- $hasCurrentBranch = true}}
{{- end}}
{{- end}}
{{- range .MergeRequests}}
{{- if .IsCurrentProject}}
│ {{getStatusEmoji .}}{{if .IsCurrentBranch}}{{bold .Title}}{{else}}{{.Title}}{{end}}
│   URL: {{.WebURL}}
{{- if getIssueURL .Title}}
│   Issue: {{getIssueURL .Title}}
{{- end}}
{{- if .Assignee}}
│   Assignee: {{.Assignee.Username}}
{{- end}}
│   Reviewers: {{ if .Reviewers}}{{joinUsernames .Reviewers}}{{else}}None{{end}}
│   Approvals: {{ if .Approvals}}{{joinUsernames .Approvals}}{{else}}None{{end}}
│   Created: {{formatTime .CreatedAt}}
│   Updated: {{formatTime .UpdatedAt}}
│
{{- if .IsCurrentBranch}}
├──────────────────────────────────────────────────────────────────────────────────────────────────┤
│
{{- end}}
{{- end}}
{{- end}}
{{formatBoxBottom}}
{{- end}}

{{- /* Other Project MRs */}}
{{- if .OtherMRsByProject }}
{{- range $projectName, $mrs := .OtherMRsByProject }}
{{formatBoxTitle $projectName}}
│
{{- range $mrs }}
│ {{getStatusEmoji .}}{{.Title}}
│   URL: {{.WebURL}}
{{- if getIssueURL .Title}}
│   Issue: {{getIssueURL .Title}}
{{- end}}
{{- if .Assignee}}
│   Assignee: {{.Assignee.Username}}
{{- end}}
│   Reviewers: {{ if .Reviewers}}{{joinUsernames .Reviewers}}{{else}}None{{end}}
│   Approvals: {{ if .Approvals}}{{joinUsernames .Approvals}}{{else}}None{{end}}
│   Created: {{formatTime .CreatedAt}}
│   Updated: {{formatTime .UpdatedAt}}
│
{{- end}}
{{formatBoxBottom}}
{{- end}}
{{- end}}

{{- end}}